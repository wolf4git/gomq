#!/bin/sh
scriptName="$(basename ${0})"
logFile="/${MQ_CONIX_PATH}/${scriptName}.log"
logFileTmp="/${MQ_CONIX_PATH}/${scriptName}.temp.log"

setupScriptName="mq-setup.sh"
setupLogFile="/${MQ_CONIX_PATH}/${scriptName}.log"

# -----------------------------------------------------------------------------
mecho(){
    echo "[`date +%F_%T_%z` ${scriptName}] ${*}" 
}
# -----------------------------------------------------------------------------
decho(){
    echo "[`date +%F_%T_%z` ${scriptName} Direct] ${*}" 
}
# -----------------------------------------------------------------------------
lecho(){
    mecho ${*} >> ${logFile}
}
# -----------------------------------------------------------------------------
dlecho(){
    decho ${*}
    lecho ${*} >> ${logFile}
}
# -----------------------------------------------------------------------------
runCmd(){
    _job="${1}"
    shift 1
    _cmd="${*}"
    printf "\n-i- ----------------------------------------------------------------------------\n"
    printf "\n-i- ___${_job}"
    printf "\n-i- ${_cmd}"
    printf "\n-i- ----------------------------------------------------------------------------\n"
    ${_cmd}
}

lecho "................................................................................."
lecho "--- this is log [${logFile}] from [${scriptName}]"
lecho "................................................................................."
dlecho "Hallo from ${scriptName}"
lecho "................................................................................."
lecho "Running as " `id`
lecho "..."

lecho "..."
lecho "................................................................................."
dlecho "start ${setupScriptName}"
lecho "................................................................................."
lecho "..."

    /${MQ_CONIX_PATH}/${setupScriptName} 30 2>>${setupLogFile} &

lecho "................................................................................."
dlecho "start origin EntryPoint:runmqdevserver in 3 seconds"
lecho "................................................................................."
lecho "..."
sleep 3

lecho "................................................................................."
dlecho "Display finally the complete log from ${scriptName}"
lecho "................................................................................."
dlecho "start runmqdevserver"

    lecho "................................................................................."
    dlecho "...${scriptName} done, runmqdevserver is running"
    lecho "................................................................................."
    cat ${logFile}

    runmqdevserver 

mecho "...${scriptName} done"
